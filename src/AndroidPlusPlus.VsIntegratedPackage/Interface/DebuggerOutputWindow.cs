////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Text;

using Microsoft.VisualStudio;
using Microsoft.VisualStudio.Shell;
using Microsoft.VisualStudio.Shell.Interop;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

namespace AndroidPlusPlus.VsIntegratedPackage
{

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  public class DebuggerOutputWindow
  {

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    private static IVsOutputWindow s_outputWindow = null;

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    private static IVsOutputWindow AquireOutputWindow ()
    {
      ThreadHelper.ThrowIfNotOnUIThread();

      return Package.GetGlobalService (typeof (SVsOutputWindow)) as IVsOutputWindow;
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public static void WriteLine (Guid outputPaneGuid, string line)
    {
      // 
      // Output specified line to the pane represented by the provided Guid.
      //   i.e. VSConstants.OutputWindowPaneGuid.DebugPane_guid
      // 

      IVsOutputWindowPane debugWindowPane = null;

      if (s_outputWindow == null)
      {
        s_outputWindow = AquireOutputWindow ();
      }

      if ((s_outputWindow != null) && (s_outputWindow.GetPane (outputPaneGuid, out debugWindowPane) != VSConstants.S_OK))
      {
        ErrorHandler.ThrowOnFailure (s_outputWindow.CreatePane (outputPaneGuid, "General", 1, 0));

        ErrorHandler.ThrowOnFailure (s_outputWindow.GetPane (outputPaneGuid, out debugWindowPane));
      }

      if (debugWindowPane != null)
      {
        ErrorHandler.ThrowOnFailure (debugWindowPane.Activate ());

        ErrorHandler.ThrowOnFailure (debugWindowPane.OutputString (line + Environment.NewLine));
      }
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  }

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
