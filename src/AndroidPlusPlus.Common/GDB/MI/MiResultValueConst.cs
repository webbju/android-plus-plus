////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections;
using System.Collections.Generic;
using System.Globalization;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

namespace AndroidPlusPlus.Common
{

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  public class MiResultValueConst : MiResultValue
  {

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    private readonly string m_rawConstValue;

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public MiResultValueConst (string variable, string value)
      : base (variable)
    {
      if (string.IsNullOrWhiteSpace (variable))
      {
        throw new ArgumentNullException (nameof(variable));
      }

      if (value == null)
      {
        throw new ArgumentNullException (nameof(value));
      }

      m_valueList = new List<MiResultValue>
      {
        this
      };

      m_fieldDictionary = new Dictionary<string, List<MiResultValue>>
      {
        { variable, m_valueList }
      };

      m_rawConstValue = value;
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public override string GetString ()
    {
      // 
      // Strip quotation marks on const value parameters.
      // 

      if ((m_rawConstValue.Length > 0) 
        && (m_rawConstValue [0] == '"') 
        && (m_rawConstValue [m_rawConstValue.Length - 1] == '"'))
      {
        return m_rawConstValue.Substring (1, m_rawConstValue.Length - 2);
      }

      return m_rawConstValue;
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public override int GetInt ()
    {
      string literal = GetString ();

      if (literal.ToLower ().StartsWith ("0x"))
      {
        return int.Parse (literal.Substring (2), NumberStyles.HexNumber);
      }

      return int.Parse (literal);
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public override long GetLong ()
    {
      string literal = GetString ();

      if (literal.ToLower ().StartsWith ("0x"))
      {
        return long.Parse (literal.Substring (2), NumberStyles.HexNumber);
      }

      return long.Parse (literal);
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public override uint GetUnsignedInt ()
    {
      string literal = GetString ();

      if (literal.ToLower ().StartsWith ("0x"))
      {
        return uint.Parse (literal.Substring (2), NumberStyles.HexNumber);
      }

      return uint.Parse (literal);
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public override ulong GetUnsignedLong ()
    {
      string literal = GetString ();

      if (literal.ToLower ().StartsWith ("0x"))
      {
        return ulong.Parse (literal.Substring (2), NumberStyles.HexNumber);
      }

      return ulong.Parse (literal);
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    public override string ToString ()
    {
      return Variable + "=" + m_rawConstValue;
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  }

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
