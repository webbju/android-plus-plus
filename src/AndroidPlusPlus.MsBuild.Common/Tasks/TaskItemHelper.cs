using Microsoft.Build.Framework;
using System;

namespace AndroidPlusPlus.MsBuild.Common.Tasks
{

  public class TaskItemHelper
  {

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    internal readonly ITaskItem _taskItem;

    public TaskItemHelper(ITaskItem taskItem)
    {
      _taskItem = taskItem ?? throw new ArgumentNullException(nameof(taskItem));
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    // 
    // Accessors for well-known item metadata.
    // https://docs.microsoft.com/en-us/visualstudio/msbuild/msbuild-well-known-item-metadata?view=vs-2019
    // 

    public ITaskItem TaskItem { get => _taskItem; }

    public string FullPath => _taskItem.GetMetadata(nameof(FullPath));

    public string RootDir => _taskItem.GetMetadata(nameof(RootDir));

    public string Filename => _taskItem.GetMetadata(nameof(Filename));

    public string Extension => _taskItem.GetMetadata(nameof(Extension));

    public string RelativeDir => _taskItem.GetMetadata(nameof(RelativeDir));

    public string Directory => _taskItem.GetMetadata(nameof(Directory));

    public string RecursiveDir => _taskItem.GetMetadata(nameof(RecursiveDir));

    public string Identity => _taskItem.GetMetadata(nameof(Identity));

    public string ModifiedTime => _taskItem.GetMetadata(nameof(ModifiedTime));

    public string CreatedTime => _taskItem.GetMetadata(nameof(CreatedTime));

    public string AccessedTime => _taskItem.GetMetadata(nameof(AccessedTime));

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  }

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}
